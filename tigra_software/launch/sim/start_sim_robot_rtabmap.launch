<?xml version="1.0" encoding="UTF-8"?>

<launch>
    <arg name="map_name" default="map.db"/>
    <arg name="localization" default="false"/> <!-- set false to start mapping with move_base-->
    <arg name="debug" default="false"/>
    <arg name='rviz' default="false"/>
    <arg name='rtabmapviz' default='true'/>

    <include file="$(find tigra_description)/launch/tigra.launch">
        <arg name="world" value="$(find tigra_maps)/worlds/lab.world"/>
        <arg name="gui" value="false"/>
    </include>
    <include file="$(find tigra_software)/launch/drivers/uc_convertion_layer.launch">
        <arg name="publish_tf" value="false"/>
    </include>

    <include file="$(find tigra_software)/launch/drivers/ekf_odom.launch">
        <arg name="folder_name" value="ekf_sim"/>
    </include>
    <!-- <include file="$(find tigra_software)/launch/drivers/ekf_map.launch"></include> -->

    <include file="$(find tigra_software)/launch/view/rviz_start.launch">
        <arg name="rvizconfig" value="$(find tigra_software)/config/rviz/common_sim.rviz"/>
    </include>

    <include file="$(find tigra_software)/launch/drivers/move_base.launch">
        <arg name="folder_name" value="move_base_sim"/>
        <arg name="cmd_topic" value="/tigra/cmd_vel"/>
    </include>

    <include file="$(find tigra_vision)/launch/rtabmap_sim.launch">
        <arg name="localization" value="$(arg localization)"/>
        <arg name="database_path" value="$(find tigra_maps)/3d_maps/$(arg map_name)"/>
        <arg name="rtabmapviz" value="$(arg rtabmapviz)"/>
    </include>

    <!-- rs_camera_depth_optical_frame - required only for simulator, in real driver it publishes itself -->
    <!-- rs_camera_optical_frame - for simulator we make small rename =) -->
    <node pkg="tf" type="static_transform_publisher" name="rs_camera_link_2_rs_camera_optical_frame"
          args="0 0 0 -1.57079632679 0 -1.57079632679 /rs_camera_link /rs_camera_optical_frame 1000"/>
    <node pkg="tf" type="static_transform_publisher" name="rs_camera_link_2_camera_depth_frame"
          args="0 0 0 0 0 0 /rs_camera_link /camera_depth_frame 100"/>
</launch>